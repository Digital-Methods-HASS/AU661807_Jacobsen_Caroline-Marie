---
title: "Danish Kings, W.10"
author: "Caroline Marie Jacobsen"
date: "07-03-2025"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

To solve the task I will start by loading my Danish Monarchs csv file into R and using the tidyverse package to extract the data. Then I will calculate and illustrate the kings duration of reign using pipes.

## Loading the kings

I will start by setting up a dataframe by loading the Danish Monarchs csv file into R. The separator for my csv file is ",". To figure out how to create the Danish Monarchs objects I will test the different functions below.

-   `read.csv()`
-   `read_csv()`
-   `read.csv2()`
-   `read_csv2()`

```{r eval = TRUE}

library(tidyverse)

kings1 <- read.csv("data/Kongerækken.csv")

kings2 <- read_csv("data/Kongerækken.csv")

kings3 <- read.csv2("data/Kongerækken.csv")

kings4 <- read_csv2("data/Kongerækken.csv")


```

## Answering questions

1.  Which of these functions is a `tidyverse` function? Read data with it below into a `kings` object\

-   Kings 2 and 4 are tidyverse functions, while kings 1 and 3 are base R functions.

2.  What is the result of running `class()` on the `kings` object created with a tidyverse function.\

-   When running class(kings) it shows that the object kings is a tibble (tbl) data frame.

3.  How many columns does the object have when created with these different functions?\

-   To find the number of columns I type ncol(kings). It will be 1 or 8 columns. In which case the right result is the one with 8.

4.  Show the dataset so that we can see how R interprets each column\

-   To show the dataset I type glimpse(kings). It will show me how R interprects each column. The results can be seen below.

```{r eval = TRUE}

kings <- read_csv("data/Kongerækken.csv")

class(kings)

ncol(kings)

glimpse(kings)
```

## Calculating the duration of reign for all the kings
I will calculate the duration of reign in years using the mutate function. I will subtract start reign ("regering_Start") from end reign ("Regering_Slut") and create a new column called duration. (Antal_regeringsår)

```{r}
#The column "Antal_regeringsår" did already exist in my dataset. Here I am just showing how I would create the column and then just overriding the already existing column named "Antal_regeringsår". 

kings <- kings %>%
  mutate(Antal_regeringsår = Regering_Slut - Regering_Start)
 

```

## Calculating the average duration of reign for all rulers


```{r}
#I am finding the mean() by using base R function. By writing "kings$Antal_regeringsår", I choose only to find the average in this specific column. I am also writing na.rm = TRUE to handle any NAs. 

mean(kings$Antal_regeringsår, na.rm = TRUE)
```

```{r}
#and with summarise

kings %>% 

summarise(mean(Antal_regeringsår, na.rm = TRUE))

```

## How many and which kings enjoyed a longer-than-average duration of reign?


```{r}
#I am finding the kings who had a longer than average duration of reign using the filter function

kings_longer_than_average <- kings %>%
  filter(Antal_regeringsår > mean(Antal_regeringsår, na.rm =TRUE))

glimpse(kings_longer_than_average)

```

```{r}
#and using count() to count how many kings it applies to. 

count(kings_longer_than_average)
```

## How many days did the three longest-ruling monarchs rule?

```{r}
#I will use the slice_max function to find the 3 longest-ruling monarchs. Setting the number = 3 will give me the result. 

kings %>% 
  slice_max(Antal_regeringsår, n = 3)

```

```{r }
#I am creating the new column "Antal_dage", using the mutate function.

kings <- kings %>%
  mutate(Antal_dage = Antal_regeringsår * 365)

#And running it to show the result 

kings %>% 
  slice_max(Antal_dage, n = 3)

```
The result shows 4 instead of 3 because there is a shared first place with Christian_4 and Margrethe_2 with 52 years (18980 days) each and a shared second place with Erik_7_af_Pommern and Christian_9 with 43 years (15695 days) each.

## Challenge: Plotting the kings' duration of reign through time

I will try to illustrate the long term trend in the duration of reign among Danish monarchs and give an explanation as to why the trend has occurred below. 

I will start by plotting the duration of reign, using ggplot with geom_point() and geom_smooth.
First I select the columns I will need and use the mutate function to calculate the new column midyear (Midt_år). I am creating the new column by the following calculation: (Regering_Start + (Regering_Slut - Regering_Start) / 2 ) and adding na.rm = TRUE to remove any NAs. 

Then I will create my plot with midt_år on the x axis and Antal_regingsår on the y axis and adding geom_point and geom_smooth to create the markings and line trend on my visual.  


```{r}
# YOUR CODE
kings_column <- kings %>% 
  select(Regering_Slut, Regering_Start, Antal_regeringsår) %>%
  mutate(Midt_år = (Regering_Start + (Regering_Slut - Regering_Start) / 2 ), na.rm = TRUE) %>%
  ggplot(aes(x = Midt_år, y = Antal_regeringsår)) +
  geom_point() +
  geom_smooth()


print(kings_column)
  

```
The illustration shows a decline in the duration of reign from the periods start in 936 to around 1100 and an increase from 1100 to the end of period in 2024. There is not one explanation as to why but several factors can be taking into consideration. The last assassination of a king in Denmark happened in 1286 and in 1660 Denmark become hereditary monarchy, which meant the possible successors was not fighting over the throne anymore. The Danish society did however not get any less violent the middle ages. One should also the consider the possibly of miscellaneous illnesses resulting in the kings death as suppose to old age, which is more likely to happen in for example 1050 than in 1900. 

```{r}


```

